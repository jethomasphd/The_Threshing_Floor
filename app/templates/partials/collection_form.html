<!-- Collection Configuration Form â€” HTMX-driven -->
<form
  hx-post="/api/collect"
  hx-target="#collection-progress"
  hx-swap="innerHTML"
  hx-indicator="#thresh-submit-indicator"
>
  <!-- Subreddit name -->
  <div class="form-group">
    <label for="subreddit" class="label">Subreddit</label>
    <div class="input-group">
      <i data-lucide="hash" class="input-group-icon"></i>
      <input
        type="text"
        id="subreddit"
        name="subreddit"
        class="input"
        placeholder="e.g. mentalhealth"
        value="{{ subreddit | default('', true) }}"
        required
        autocomplete="off"
        style="padding-left: 2.5rem;"
      >
    </div>
    <p class="text-xs text-ash mt-1">Enter the subreddit name without the r/ prefix.</p>
  </div>

  <!-- Sort + Time filter row -->
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <!-- Sort method -->
    <div class="form-group">
      <label for="sort" class="label">Sort By</label>
      <select id="sort" name="sort" class="select">
        <option value="hot">Hot</option>
        <option value="new">New</option>
        <option value="top">Top</option>
        <option value="rising">Rising</option>
        <option value="controversial">Controversial</option>
      </select>
    </div>

    <!-- Time filter (shown only for top/controversial) -->
    <div class="form-group" id="time-filter-group">
      <label for="time_filter" class="label">Time Filter</label>
      <select id="time_filter" name="time_filter" class="select">
        <option value="all">All Time</option>
        <option value="year">Past Year</option>
        <option value="month">Past Month</option>
        <option value="week">Past Week</option>
        <option value="day">Past 24 Hours</option>
        <option value="hour">Past Hour</option>
      </select>
    </div>
  </div>

  <!-- Keyword search -->
  <div class="form-group">
    <label for="query" class="label">Keyword Search <span class="text-ash font-normal normal-case">(optional)</span></label>
    <div class="input-group">
      <i data-lucide="search" class="input-group-icon"></i>
      <input
        type="text"
        id="query"
        name="query"
        class="input"
        placeholder="Filter by keywords..."
        autocomplete="off"
        style="padding-left: 2.5rem;"
      >
    </div>
    <p class="text-xs text-ash mt-1">If provided, searches within the subreddit for matching posts.</p>
  </div>

  <!-- Max posts -->
  <div class="form-group">
    <label for="limit" class="label">Maximum Posts</label>
    <input
      type="number"
      id="limit"
      name="limit"
      class="input"
      value="25"
      min="1"
      max="1000"
      step="1"
    >
    <p class="text-xs text-ash mt-1">Between 1 and 1,000. Reddit may return fewer depending on availability.</p>
  </div>

  <hr class="divider">

  <!-- Include comments -->
  <div class="form-group">
    <label class="checkbox">
      <input type="checkbox" id="include_comments" name="include_comments" value="true">
      <span>Include comments</span>
    </label>
    <p class="text-xs text-ash mt-1">Collecting comments increases API usage and collection time.</p>
  </div>

  <!-- Comment options (hidden unless include_comments is checked) -->
  <div id="comment-options" style="display: none;">
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <!-- Comment depth -->
      <div class="form-group">
        <label for="comment_depth" class="label">Comment Depth</label>
        <input
          type="number"
          id="comment_depth"
          name="comment_depth"
          class="input"
          value="3"
          min="1"
          max="10"
          step="1"
        >
        <p class="text-xs text-ash mt-1">How deep to expand "more comments" (1-10).</p>
      </div>

      <!-- Comment limit per post -->
      <div class="form-group">
        <label for="comment_limit" class="label">Comments per Post</label>
        <input
          type="number"
          id="comment_limit"
          name="comment_limit"
          class="input"
          value="100"
          min="1"
          max="500"
          step="1"
        >
        <p class="text-xs text-ash mt-1">Max comments to collect per post (1-500).</p>
      </div>
    </div>
  </div>

  <hr class="divider divider-ember">

  <!-- Submit -->
  <div class="flex items-center justify-between">
    <div class="flex items-center gap-2 text-ash text-sm" id="thresh-submit-indicator">
      <span class="htmx-indicator">
        <img src="/static/img/sigil.svg" alt="" class="loading-sigil" width="20" height="20">
      </span>
    </div>
    <button type="submit" class="btn btn-primary btn-lg">
      <i data-lucide="wheat" style="width:18px;height:18px;"></i>
      Begin Threshing
    </button>
  </div>
</form>
