<!-- Job Progress â€” polls for updates while collection is running -->
<div
  class="card"
  id="job-progress-{{ job.id }}"
  hx-get="/api/collect/{{ job.id }}/status"
  hx-trigger="every 2s"
  hx-swap="outerHTML"
>
  <div class="card-body">
    <div class="flex items-center gap-3 mb-3">
      <img src="/static/img/sigil.svg" alt="" class="loading-sigil" width="24" height="24">
      <div>
        <h4 class="font-body font-medium text-bone" style="font-size:0.9375rem;">
          Collecting from r/{{ job.subreddit }}
        </h4>
        <span class="badge badge-warning mt-1">{{ job.status }}</span>
      </div>
    </div>

    <!-- Posts progress -->
    <div class="mb-3">
      <div class="progress-label">
        <span class="progress-label-text">Posts</span>
        <span class="progress-label-value">
          {{ job.collected_posts }} / {{ job.total_posts }}
        </span>
      </div>
      {% set post_pct = ((job.collected_posts / job.total_posts * 100) if job.total_posts > 0 else 0) | int %}
      <div class="progress">
        <div class="progress-fill" style="width: {{ post_pct }}%;"></div>
      </div>
    </div>

    {% if job.total_comments > 0 %}
    <!-- Comments progress -->
    <div>
      <div class="progress-label">
        <span class="progress-label-text">Comments</span>
        <span class="progress-label-value">
          {{ job.collected_comments }} / {{ job.total_comments }}
        </span>
      </div>
      {% set comment_pct = ((job.collected_comments / job.total_comments * 100) if job.total_comments > 0 else 0) | int %}
      <div class="progress">
        <div class="progress-fill" style="width: {{ comment_pct }}%;"></div>
      </div>
    </div>
    {% endif %}
  </div>
</div>
