{% extends "base.html" %}
{% block title %}Explore — Find Subreddits | Thresh{% endblock %}
{% block content %}
<div class="page-header">
  <h1 class="page-title">Explore</h1>
  <p class="page-subtitle">Scout the field before harvest — discover subreddits for your research</p>
</div>

<!-- Credential warning -->
{% if not is_configured %}
<div class="card mb-6" style="border-left: 3px solid var(--warning);">
  <div class="flex items-start gap-3">
    <i data-lucide="alert-triangle" class="w-5 h-5 text-warning flex-shrink-0 mt-0.5"></i>
    <div>
      <h3 class="font-body text-sm font-semibold text-warning mb-1">Reddit API Credentials Required</h3>
      <p class="text-bone-muted text-sm mb-2" style="line-height: 1.5;">
        You need to set up your Reddit API credentials before you can search and preview subreddits.
        This only takes a few minutes.
      </p>
      <a href="/about" class="btn btn-secondary btn-sm">
        <i data-lucide="settings" class="w-3.5 h-3.5"></i>
        Set Up Credentials
      </a>
    </div>
  </div>
</div>
{% endif %}

<!-- Search form -->
<div class="card mb-6">
  <form class="flex flex-col sm:flex-row gap-3 items-end"
        hx-get="/api/subreddits/search"
        hx-target="#search-results"
        hx-swap="innerHTML"
        hx-trigger="submit"
        hx-indicator="#search-loading">
    <div class="flex-1 w-full">
      <label for="subreddit-search" class="label">Search Subreddits</label>
      <div class="input-group">
        <i data-lucide="search" class="input-group-icon"></i>
        <input type="text"
               id="subreddit-search"
               name="q"
               class="input w-full"
               placeholder="e.g. mental health, depression, anxiety..."
               minlength="2"
               required
               autocomplete="off">
      </div>
    </div>
    <div class="w-full sm:w-auto">
      <label for="search-limit" class="label">Results</label>
      <select id="search-limit" name="limit" class="input select w-full sm:w-24">
        <option value="5">5</option>
        <option value="10" selected>10</option>
        <option value="25">25</option>
      </select>
    </div>
    <div class="w-full sm:w-auto">
      <button type="submit" class="btn btn-primary w-full sm:w-auto">
        <i data-lucide="compass" class="w-4 h-4"></i>
        Search
      </button>
    </div>
  </form>
</div>

<!-- Loading indicator -->
<div id="search-loading" class="htmx-indicator">
  <div class="loading-state">
    <img src="/static/img/sigil.svg" alt="Loading..." class="loading-sigil">
    <p class="loading-text">Searching the fields...</p>
  </div>
</div>

<!-- Results container -->
<div id="search-results">
  <!-- HTMX will swap search results here -->
  <div class="empty-state">
    <img src="/static/img/sigil.svg" alt="" class="empty-state-sigil">
    <h2 class="empty-state-heading">Begin Your Exploration</h2>
    <p class="empty-state-text">Search for subreddits by topic, name, or keyword. Discover the communities where your research subjects gather.</p>
  </div>
</div>

<!-- Subreddit detail panel (hidden by default, shown when a subreddit is selected) -->
<div id="subreddit-detail" class="mt-6"></div>
{% endblock %}
